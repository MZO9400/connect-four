(()=>{"use strict";class e extends Error{constructor(e){super("FilledRowException: "+e)}}const t=e;var r=function(e){return e.NONE="none",e.RED="red",e.YELLOW="yellow",e}(r||{});const n=r,o=(e,t,r)=>{const o=e[t].slice(Math.max(r-4,0),4),c=[],u=[],a=[];for(let n=t-3;n<=t+3;n++){const o=Math.abs(t-n),s=r-o,E=r+o;try{u.push(e[n][n<=0?E:s])}catch(l){}try{a.push(e[n][n<=0?s:E])}catch(l){}try{c.push(e[n][r])}catch(l){}}return s(o,4)||s(c,4)||s(u,4)||s(a,4)?e[t][r]:n.NONE},s=(e,t)=>e.reduce(((r,o,s)=>{const c=e.slice(Math.max(s-t,0),t);return!(c.length!==t||!c.every((e=>e===o))||![n.RED,n.YELLOW].includes(o))||r}),!1);self.onmessage=function(e){const{grid:t,forPlayer:r}=e.data;self.postMessage(c(t,r))};const c=(e,t)=>u(e,t,t).move,u=function(e,r,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const c=E(e);if(c!==n.NONE)return{score:l(c,o),move:-1};if(s>3)return{score:0,move:-1};const h=[],i=[];if(a(e).sort(((e,t)=>.5-Math.random())).forEach((c=>{const a=((e,r,o)=>{const s=e.map((e=>e.slice())),c=e[r].findIndex((e=>e===n.NONE));if(-1===c)throw new t("Column ".concat(r," has no empty rows"));return s[r][c]=o===n.YELLOW?n.YELLOW:n.RED,s})(e,c,o),l=n.RED===o?n.YELLOW:n.RED;h.push(c),i.push(u(a,r,l,s+1).score)})),r===o){let e=-1e4,t=-1;for(let r=0;r<i.length;r++)i[r]>=e&&(e=i[r],t=r);return{score:e,move:h[t]}}{let e=1e4,t=-1;for(let r=0;r<i.length;r++)i[r]<=e&&(e=i[r],t=r);return{score:e,move:h[t]}}},a=e=>{const t=[];return e.forEach(((e,r)=>{e.includes(n.NONE)&&t.push(r)})),t},l=(e,t)=>{switch(e){case n.NONE:return 0;case t:return 10;default:return-10}},E=e=>{let t=n.NONE;for(let r=0;r<e.length;r++){const s=e[r].findIndex((e=>e!==n.NONE));if(t=o(e,r,s),t!==n.NONE)break;if(t!==n.NONE)break}return t}})();
//# sourceMappingURL=657.625308aa.chunk.js.map